<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>sandbox polyFlow</title>
    <link rel="stylesheet" type="text/css" href="/sandbox/styles.css" />
</head>


<body>
    <div id="svg-container">
        <svg id="svg-main" width="500" height="500">
            <circle id="circle1" cx="50" cy="250" r="40"/>
        </svg>
    </div>
    <br>
    <div>
        <button id="add-circle">+ circle</button>
        <button id="remove-circle">- circle</button>
        min = 1 circle
        max = 5 circles
    </div><br>
    <div>
        <button id="vUp">velocity increase</button>
        <button id="vDown">velocity decrease</button>
    <div>
        <h4 id="logger"></h4>
        <h4 id="velLog"></h4>
    </div>

    <script>

        // ⚠️= critical program infrastructure.
        // 🧪 = testing/experimental components.
        // 🧰 = global variables/constants
        // 🐛 = bug/notes.

        console.log('script executed');        


        // 🧰 DOCUMENT VARIABLES 🧰
        const circleEl1 = document.getElementById("circle1");
        const velInc = document.getElementById("vUp");
        const velDec = document.getElementById("vDown");
        const svg = document.getElementById("svg-main");
        const svgW = svg.getAttribute('width');
        const svgH = svg.getAttribute('height');
        let screenLog = document.getElementById("logger");
        let velLog = document.getElementById("velLog");
        const addCircleButton = document.getElementById("add-circle");
        const removeCircleButton = document.getElementById("remove-circle");

        // 🧰 PHYSICS VARIABLES 🧰
        let cx;// = circleEl1.getAttribute('cx');
        let cy; //= circleEl1.getAttribute('cy');
        var t = 0;
        let mouseX;
        let mouseY;
        let circle; // make extra param to treat all cirlces as one to engage FOR


        // ⚠️ Set circle position function
        const setCirclePos = (_cx, _cy) => {
            // console.log(_cx, _cy);
            circleEl1.setAttribute('cx', _cx);
            circleEl1.setAttribute('cy', _cy);
        };

        // ⚠️ PHYSICS PARAMETERS AND PROPERTYS ⚠️
        //position
        let pX = 250, pY = 250;
        //velocity
        let vX = 1, vY = 2;
        //acceleration
        let aX, aY; // (keep as zero for now)

        // display default velocity values
        velLog.innerHTML = `
                velocityX: ${vX}
                velocityY: ${vY}`;

        // updates velocity/position thru main time loop. 
        function updatePhysics(){
            //if set velocity from slider, etc, dont have these two
            // vX += aX;
            // vY += aY;
            pX += vX;
            pY += vY;
        };

        const velocityIncrease = () => {
            vY*=1.5;
            vX*=1.5;
            console.log(vX, vY);
            velLog.innerHTML = `
                velocityX: ${vX}
                velocityY: ${vY}`;

        };
        const velocityDecrease = () => {
            vX/=1.5;
            vY/=1.5;
            console.log(vX, vY);
            velLog.innerHTML = `
                velocityX: ${vX}
                velocityY: ${vY}`;
        }

        // event handlers for velocity increase & decrease
        velInc.addEventListener("click", velocityIncrease)
        velDec.addEventListener("click", velocityDecrease)

        // Add action for when passes boundry of SVG
        function physicsConditions(circle){

            // if circle is past rhs of screen
            if (pX >= svgW - 40) {
                // cx = svgW - 40;
                vX = -Math.abs(vX);
                //if circle is past lhs of screen
                } else if (pX <= 40) {
                // cx = 40;
                //make sure circle isnt moving left
                    vX = Math.abs(vX);
                };

            if (pY >= svgH - 40) {
                // cy = svgH - 40;
                vY = -Math.abs(vY);
                } else if (pY <= 40) {
                // cy = 40;
                vY = Math.abs(vY);
                };
        };




        // 🧪 !!EXPERIEMENT!! 🧪
        // FORloop to create circles dependant on user input.

        // array for amount of circles 
        circlesArray = [];

        const circleDOM = () => {
        
        // event handlers to add / remove circles
        addCircleButton.addEventListener("click", addCircle);
        removeCircleButton.addEventListener("click", removeCircle);


        function addCircle () {
            circlesArray.push(1);
            console.log(circlesArray);

            for (let i = 0; i < circlesArray.length; i++) {
            let circleEl = document.createElement('circle');
            circleEl.setAttribute("cx", 250);
            circleEl.setAttribute("cy", 250);
            circleEl.setAttribute("r", 40);
            circleEl.setAttribute("id", "circle"+[i]);
            svg.appendChild(circleEl);
        }};


        function removeCircle () {
            circlesArray.pop();
            console.log(circlesArray);
        };
        }; // end circleDOM function



        circleDOM();
        


        // ⚠️ MAIN TIME LOOP TO RUN SVG APPLICATION ⚠️
        const mainLoop = () => {
            // t++;

            // cx = mouseX;
            // cy = mouseY;
            
            physicsConditions();

            updatePhysics();



            // func to set x and y values
            setCirclePos(pX,pY)

            requestAnimationFrame(mainLoop);
        };


        function logKey(e) {
            screenLog.innerText = `
                Screen X/Y: ${e.screenX}, ${e.screenY}
                Client X/Y: ${e.clientX}, ${e.clientY}`;
                // mouseX = e.clientX;
                // mouseY = e.clientY;
            };

        document.addEventListener("mousemove", logKey);

        requestAnimationFrame(mainLoop);


    </script>

    <!-- <div id="test-container">

        <canvas id="myCanvas" width="500" height="200"></canvas>

        <script>
            const canvas = document.getElementById("myCanvas");
            const ctx = canvas.getContext("2d");

            const amplitude = 50; // amplitude of the wave
            const frequency = 0.05; // frequency of the wave
            const phaseShift = 0; // phase shift of the wave

            ctx.beginPath();



            for (let x = 0; x <= canvas.width; x++) {
            // Calculate the y-coordinate of the sine wave at the current x-coordinate
            const y = amplitude * Math.sin(2 * Math.PI * frequency * x + phaseShift);

            // Draw a line segment from the previous point to the current point
            if (x === 0) {
                ctx.moveTo(x, canvas.height / 2 + y);
            } else {
                ctx.lineTo(x, canvas.height / 2 + y);
            }
            }

            ctx.stroke();

        </script>

    </div> -->
</body>
</html>